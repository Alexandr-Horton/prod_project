"use strict";(self.webpackChunkprod_project=self.webpackChunkprod_project||[]).push([[676],{8791:function(e,a,n){n.d(a,{I:function(){return s}});var r=n(7294),l=n(3007),t=n(5893);const s=(0,r.memo)((e=>{const{className:a,value:n,onChange:s,type:o="text",placeholder:i,autofocus:d,readonly:c,...u}=e,h=(0,r.useRef)(null),[g,x]=(0,r.useState)(!1),[v,p]=(0,r.useState)(0),m=g&&!c;return(0,r.useEffect)((()=>{var e;d&&(x(!0),null===(e=h.current)||void 0===e||e.focus())}),[d]),(0,t.jsxs)("div",{className:(0,l.A)("p_6dRLUG",{},[a]),children:[i&&(0,t.jsx)("div",{className:"uWIRRz2O",children:"".concat(i,">")}),(0,t.jsxs)("div",{className:"tDY7ayAp",children:[(0,t.jsx)("input",{ref:h,type:o,value:n,onChange:e=>{null==s||s(e.target.value),p(e.target.value.length)},className:"Z6IBiNl_",onFocus:()=>{x(!0)},onBlur:()=>{x(!1)},onSelect:e=>{var a;p((null==e||null===(a=e.target)||void 0===a?void 0:a.selectionStart)||0)},readOnly:c,...u}),m&&(0,t.jsx)("span",{className:"Y3U88xm_",style:{left:"".concat(9*v,"px")}})]})]})}))},169:function(e,a,n){n.d(a,{I:function(){return d}});var r=n(7294),l=n(3007),t={InputWrapper:"ZyI7rxIe",s:"mKldd7L_",m:"IyQiG8hL",l:"j7JcqtN4",addonLeft:"OqwwYwm8",addonRight:"o_xLYaZC",withAddonLeft:"zVArqqw4",withAddonRight:"HxXya_r8",focused:"jUzuVRdk",input:"L2BiQ3jT",readonly:"xspqW3a0"},s=n(9244),o=n(8969),i=n(5893);const d=(0,r.memo)((e=>{const{className:a,value:n,onChange:d,type:c="text",placeholder:u,autofocus:h,readonly:g,addonLeft:x,addonRight:v,label:p,size:m="m",...C}=e,f=(0,r.useRef)(null),[j,R]=(0,r.useState)(!1);(0,r.useEffect)((()=>{var e;h&&(R(!0),null===(e=f.current)||void 0===e||e.focus())}),[h]);const y={[t.readonly]:g,[t.focused]:j,[t.withAddonLeft]:Boolean(x),[t.withAddonRight]:Boolean(v)},N=(0,i.jsxs)("div",{className:(0,l.A)(t.InputWrapper,y,[a,t[m]]),children:[(0,i.jsx)("div",{className:t.addonLeft,children:x}),(0,i.jsx)("input",{ref:f,type:c,value:n,onChange:e=>{null==d||d(e.target.value)},className:t.input,onFocus:()=>{R(!0)},onBlur:()=>{R(!1)},readOnly:g,placeholder:u,...C}),(0,i.jsx)("div",{className:t.addonRight,children:v})]});return p?(0,i.jsxs)(s.U,{max:!0,gap:"8",children:[(0,i.jsx)(o.x,{text:p}),N]}):N}))},2676:function(e,a,n){n.r(a),n.d(a,{default:function(){return te}});var r=n(6974),l=n(3007),t=n(1492),s=n(9244),o=n(2327),i=n(7294),d=n(743),c=n(5401),u=n(9970),h=n(526),g=n(7499),x={ProfileCard:"QTLlYN1L",loading:"TX39V40k",error:"bA_iT2GX",editing:"FmG40szU"},v=n(9085),p=n(8791);let m;!function(e){e.RUB="RUB",e.EUR="EUR",e.USD="USD"}(m||(m={}));var C=n(2005),f=n(5108),j=n(5893);const R=[{value:m.RUB,content:m.RUB},{value:m.EUR,content:m.EUR},{value:m.USD,content:m.USD}],y=(0,i.memo)((e=>{let{className:a,value:n,onChange:r,readonly:l}=e;const{t:t}=(0,o.$)(),s=(0,i.useCallback)((e=>{null==r||r(e)}),[r]),d={className:a,value:n,defaultValue:t("Укажите валюту"),label:t("Укажите валюту"),items:R,onChange:s,readonly:l,direction:"top right"};return(0,j.jsx)(g.zJ,{feature:"isAppRedesigned",on:(0,j.jsx)(f.wb,{...d}),off:(0,j.jsx)(C.wb,{...d})})}));let N;!function(e){e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia"}(N||(N={}));const E=[{value:N.Armenia,content:N.Armenia},{value:N.Russia,content:N.Russia},{value:N.Belarus,content:N.Belarus},{value:N.Kazakhstan,content:N.Kazakhstan},{value:N.Ukraine,content:N.Ukraine}],A=(0,i.memo)((e=>{let{className:a,value:n,onChange:r,readonly:l}=e;const{t:t}=(0,o.$)(),s=(0,i.useCallback)((e=>{null==r||r(e)}),[r]),d={className:a,value:n,defaultValue:t("Укажите страну"),label:t("Укажите страну"),items:E,onChange:s,readonly:l,direction:"top right"};return(0,j.jsx)(g.zJ,{feature:"isAppRedesigned",on:(0,j.jsx)(f.wb,{...d}),off:(0,j.jsx)(C.wb,{...d})})}));var U=n(7953);const O=()=>{const{t:e}=(0,o.$)();return(0,j.jsx)(s.U,{justify:"center",max:!0,className:(0,l.A)(x.ProfileCard,{},[x.error]),children:(0,j.jsx)(h.xv,{theme:h.lg.ERROR,title:e("Произошла ошибка при загрузке профиля"),text:e("Попробуйте обновить страницу"),align:h.PH.CENTER})})},b=()=>(0,j.jsx)(s.U,{justify:"center",max:!0,className:(0,l.A)(x.ProfileCard,{[x.loading]:!0}),children:(0,j.jsx)(U.a,{})}),I=(0,i.memo)((e=>{const{className:a,data:n,readonly:r,onChangeFirstname:t,onChangeLastname:i,onChangeAge:d,onChangeCity:c,onChangeAvatar:u,onChangeUsername:h,onChangeCountry:g,onChangeCurrency:m}=e,{t:C}=(0,o.$)("profile"),f={[x.editing]:!r};return(0,j.jsxs)(s.g,{gap:"8",max:!0,className:(0,l.A)(x.ProfileCard,f,[a]),children:[(null==n?void 0:n.avatar)&&(0,j.jsx)(s.U,{justify:"center",max:!0,className:x.avatarWrapper,children:(0,j.jsx)(v.q,{src:null==n?void 0:n.avatar})}),(0,j.jsx)(p.I,{value:null==n?void 0:n.first,placeholder:C("Ваше имя"),className:x.input,onChange:t,readonly:r}),(0,j.jsx)(p.I,{value:null==n?void 0:n.lastname,placeholder:C("Ваша фамилия"),className:x.input,onChange:i,readonly:r}),(0,j.jsx)(p.I,{value:null==n?void 0:n.age,placeholder:C("Ваш возраст"),className:x.input,onChange:d,readonly:r}),(0,j.jsx)(p.I,{value:null==n?void 0:n.city,placeholder:C("Город"),className:x.input,onChange:c,readonly:r}),(0,j.jsx)(p.I,{value:null==n?void 0:n.username,placeholder:C("Введите имя пользователя"),className:x.input,onChange:h,readonly:r}),(0,j.jsx)(p.I,{value:null==n?void 0:n.avatar,placeholder:C("Введите ссылку на аватар"),className:x.input,onChange:u,readonly:r}),(0,j.jsx)(y,{className:x.input,value:null==n?void 0:n.currency,onChange:m,readonly:r}),(0,j.jsx)(A,{className:x.input,value:null==n?void 0:n.country,onChange:g,readonly:r})]})}));var T=n(7231),_=n(7184),k=n(169),w=n(6265),L=n(8969);const z=()=>{const{t:e}=(0,o.$)();return(0,j.jsx)(s.U,{justify:"center",max:!0,children:(0,j.jsx)(L.x,{variant:"error",title:e("Произошла ошибка при загрузке профиля"),text:e("Попробуйте обновить страницу"),align:"center"})})},S=()=>(0,j.jsx)(T.Z,{padding:"24",max:!0,children:(0,j.jsxs)(s.g,{gap:"32",children:[(0,j.jsx)(s.U,{max:!0,justify:"center",children:(0,j.jsx)(w.O,{border:"100%",width:128,height:128})}),(0,j.jsxs)(s.U,{gap:"32",max:!0,children:[(0,j.jsxs)(s.g,{gap:"16",max:!0,children:[(0,j.jsx)(w.O,{width:"100%",height:38}),(0,j.jsx)(w.O,{width:"100%",height:38}),(0,j.jsx)(w.O,{width:"100%",height:38}),(0,j.jsx)(w.O,{width:"100%",height:38})]}),(0,j.jsxs)(s.g,{gap:"16",max:!0,children:[(0,j.jsx)(w.O,{width:"100%",height:38}),(0,j.jsx)(w.O,{width:"100%",height:38}),(0,j.jsx)(w.O,{width:"100%",height:38}),(0,j.jsx)(w.O,{width:"100%",height:38})]})]})]})}),D=(0,i.memo)((e=>{const{className:a,data:n,readonly:r,onChangeFirstname:l,onChangeLastname:t,onChangeAge:i,onChangeCity:d,onChangeAvatar:c,onChangeUsername:u,onChangeCountry:h,onChangeCurrency:g}=e,{t:x}=(0,o.$)("profile");return(0,j.jsx)(T.Z,{padding:"24",border:"partial",max:!0,className:a,children:(0,j.jsxs)(s.g,{gap:"32",children:[(null==n?void 0:n.avatar)&&(0,j.jsx)(s.U,{justify:"center",max:!0,children:(0,j.jsx)(_.q,{size:128,src:null==n?void 0:n.avatar})}),(0,j.jsxs)(s.U,{gap:"24",max:!0,children:[(0,j.jsxs)(s.g,{gap:"16",max:!0,children:[(0,j.jsx)(k.I,{value:null==n?void 0:n.first,label:x("Имя"),onChange:l,readonly:r}),(0,j.jsx)(k.I,{value:null==n?void 0:n.lastname,label:x("Фамилия"),onChange:t,readonly:r}),(0,j.jsx)(k.I,{value:null==n?void 0:n.age,label:x("Возраст"),onChange:i,readonly:r}),(0,j.jsx)(k.I,{value:null==n?void 0:n.city,label:x("Город"),onChange:d,readonly:r})]}),(0,j.jsxs)(s.g,{gap:"16",max:!0,children:[(0,j.jsx)(k.I,{value:null==n?void 0:n.username,label:x("Имя пользователя"),onChange:u,readonly:r}),(0,j.jsx)(k.I,{value:null==n?void 0:n.avatar,label:x("Cсылка на аватар"),onChange:c,readonly:r}),(0,j.jsx)(y,{value:null==n?void 0:n.currency,onChange:g,readonly:r}),(0,j.jsx)(A,{value:null==n?void 0:n.country,onChange:h,readonly:r})]})]})]})})})),P=e=>{const{isLoading:a,error:n}=e,{t:r}=(0,o.$)();return a?(0,j.jsx)(g.zJ,{feature:"isAppRedesigned",on:(0,j.jsx)(S,{}),off:(0,j.jsx)(b,{})}):n?(0,j.jsx)(g.zJ,{feature:"isAppRedesigned",on:(0,j.jsx)(z,{}),off:(0,j.jsx)(O,{})}):(0,j.jsx)(g.zJ,{feature:"isAppRedesigned",on:(0,j.jsx)(D,{...e}),off:(0,j.jsx)(I,{...e})})};var B=n(1233);let V;!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(V||(V={}));const W=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.form},Y=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.isLoading},$=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.error},G=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.readonly},q=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.validateErrors};var F=n(4268);const J=(0,F.hg)("profile/fetchProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r}=a;try{const a=await n.api.get("/profile/".concat(e));if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),r("error")}})),Z=(0,F.hg)("profile/updateProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r,getState:l}=a,t=W(l()),s=(e=>{if(!e)return[V.NO_DATA];const{first:a,lastname:n,age:r,country:l}=e,t=[];return a&&n||t.push(V.INCORRECT_USER_DATA),r&&Number.isInteger(r)||t.push(V.INCORRECT_AGE),l||t.push(V.INCORRECT_COUNTRY),t})(t);if(s.length)return r(s);try{const e=await n.api.put("/profile/".concat(null==t?void 0:t.id),t);if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),r([V.SERVER_ERROR])}})),K=(0,F.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}}},extraReducers:e=>{e.addCase(J.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(J.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(J.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(Z.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(Z.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(Z.rejected,((e,a)=>{e.isLoading=!1,e.validateErrors=a.payload}))}}),{actions:M}=K,{reducer:Q}=K;var X=n(7702),H=n(8029);const ee=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.data};var ae=n(8190);const ne=(0,i.memo)((e=>{const{className:a}=e,{t:n}=(0,o.$)("profile"),r=(0,d.v9)(H.m5),t=(0,d.v9)(ee),u=(null==r?void 0:r.id)===(null==t?void 0:t.id),x=(0,d.v9)(G),v=(0,c.T)(),p=(0,i.useCallback)((()=>{v(M.setReadonly(!1))}),[v]),m=(0,i.useCallback)((()=>{v(M.cancelEdit())}),[v]),C=(0,i.useCallback)((()=>{v(Z())}),[v]);return(0,j.jsx)(g.zJ,{feature:"isAppRedesigned",on:(0,j.jsx)(T.Z,{padding:"24",fullWidth:!0,border:"partial",children:(0,j.jsxs)(s.U,{max:!0,justify:"between",className:(0,l.A)("",{},[a]),children:[(0,j.jsx)(L.x,{title:n("Профиль")}),u&&(0,j.jsx)("div",{children:x?(0,j.jsx)(ae.z,{onClick:p,children:n("Редактировать")}):(0,j.jsxs)(s.U,{gap:"8",children:[(0,j.jsx)(ae.z,{onClick:m,color:"error",children:n("Отменить")}),(0,j.jsx)(ae.z,{onClick:C,color:"success",children:n("Сохранить")})]})})]})}),off:(0,j.jsxs)(s.U,{max:!0,justify:"between",className:(0,l.A)("",{},[a]),children:[(0,j.jsx)(h.xv,{title:n("Профиль")}),u&&(0,j.jsx)("div",{children:x?(0,j.jsx)(X.zx,{theme:X.bn.OUTLINE,onClick:p,children:n("Редактировать")}):(0,j.jsxs)(s.U,{gap:"8",children:[(0,j.jsx)(X.zx,{theme:X.bn.OUTLINE_RED,onClick:m,children:n("Отменить")}),(0,j.jsx)(X.zx,{theme:X.bn.OUTLINE,onClick:C,children:n("Сохранить")})]})})]})})})),re={profile:Q},le=(0,i.memo)((e=>{const{className:a,id:n}=e,{t:r}=(0,o.$)("profile"),t=(0,c.T)(),g=(0,d.v9)(W),x=(0,d.v9)(Y),v=(0,d.v9)($),p=(0,d.v9)(G),m=(0,d.v9)(q),C={[V.SERVER_ERROR]:r("Серверная ошибка при сохранении"),[V.INCORRECT_COUNTRY]:r("Некорректный регион"),[V.NO_DATA]:r("Данные не указаны"),[V.INCORRECT_USER_DATA]:r("Имя и фамилия обязательны"),[V.INCORRECT_AGE]:r("Некорректный возраст")};(0,u.Q)((()=>{n&&t(J(n))}));const f=(0,i.useCallback)((e=>{t(M.updateProfile({first:e||""}))}),[t]),R=(0,i.useCallback)((e=>{t(M.updateProfile({lastname:e||""}))}),[t]),y=(0,i.useCallback)((e=>{t(M.updateProfile({city:e||""}))}),[t]),N=(0,i.useCallback)((e=>{t(M.updateProfile({age:Number(e||0)}))}),[t]),E=(0,i.useCallback)((e=>{t(M.updateProfile({username:e||""}))}),[t]),A=(0,i.useCallback)((e=>{t(M.updateProfile({avatar:e||""}))}),[t]),U=(0,i.useCallback)((e=>{t(M.updateProfile({currency:e}))}),[t]),O=(0,i.useCallback)((e=>{t(M.updateProfile({country:e}))}),[t]);return(0,j.jsx)(B.W,{reducers:re,children:(0,j.jsxs)(s.g,{gap:"16",max:!0,className:(0,l.A)("",{},[a]),children:[(0,j.jsx)(ne,{}),(null==m?void 0:m.length)&&m.map((e=>(0,j.jsx)(h.xv,{theme:h.lg.ERROR,text:C[e]},e))),(0,j.jsx)(P,{data:g,isLoading:x,error:v,readonly:p,onChangeFirstname:f,onChangeLastname:R,onChangeAge:N,onChangeCity:y,onChangeUsername:E,onChangeAvatar:A,onChangeCurrency:U,onChangeCountry:O})]})})}));var te=e=>{let{className:a}=e;const{id:n}=(0,r.UO)();return(0,j.jsx)(t.T,{className:(0,l.A)("",{},[a]),children:(0,j.jsx)(s.g,{gap:"16",max:!0,children:(0,j.jsx)(le,{id:n})})})}},1233:function(e,a,n){n.d(a,{W:function(){return s}});var r=n(7294),l=n(743),t=n(5893);const s=e=>{const{children:a,reducers:n,removeAfterUnmount:s=!0}=e,o=(0,l.oR)(),i=(0,l.I0)();return(0,r.useEffect)((()=>{const e=o.reducerManager.getMountedReducers();return Object.entries(n).forEach((a=>{let[n,r]=a;e[n]||(o.reducerManager.add(n,r),i({type:"@INIT ".concat(n," reducer")}))})),()=>{s&&Object.entries(n).forEach((e=>{let[a,n]=e;o.reducerManager.remove(a),i({type:"@DESTROY ".concat(a," reducer")})}))}}),[]),(0,t.jsx)(t.Fragment,{children:a})}}}]);